<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>PixelVerse | Pro Online Hub</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script>
    <style>
        :root { --p: #00ff88; --bg: #0d0d12; }
        body, html { margin: 0; padding: 0; background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; height: 100vh; }
        
        #portal { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; position: relative; z-index: 10; }
        .logo { font-size: 50px; font-weight: 800; color: var(--p); text-shadow: 0 0 20px rgba(0,255,136,0.3); margin-bottom: 40px; }
        .grid { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
        .card { background: #1f1f27; border: 2px solid #2a2a35; padding: 25px; border-radius: 15px; width: 240px; cursor: pointer; transition: 0.3s; text-align: center; }
        .card:hover { border-color: var(--p); transform: translateY(-5px); }
        .card h3 { color: var(--p); margin: 10px 0; }

        #game-view { display: none; position: fixed; inset: 0; z-index: 100; background: #000; }
        #top-ui { position: absolute; top: 15px; left: 15px; z-index: 1000; display: flex; gap: 10px; }
        .btn { background: #ff4444; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        
        /* Minecraft UI */
        #mc-setup { position: absolute; inset: 0; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; flex-direction: column; z-index: 500; }
        #crosshair { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-size: 24px; pointer-events: none; z-index: 400; display: none; }
        
        /* Car UI */
        #car-data { position: absolute; top: 60px; left: 15px; color: lime; font-size: 20px; display: none; z-index: 400; background: rgba(0,0,0,0.5); padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>

<div id="portal">
    <div class="logo">PIXELVERSE</div>
    <div class="grid">
        <div class="card" onclick="initGame('car')">
            <div style="font-size:50px">üèéÔ∏è</div>
            <h3>Traffic Racer</h3>
            <p>Hƒ±z yap ve ara√ßlarƒ± patlat!</p>
        </div>
        <div class="card" onclick="initGame('mc')">
            <div style="font-size:50px">üåç</div>
            <h3>Online Survival</h3>
            <p>Arkada≈üƒ±nla beraber in≈üa et.</p>
        </div>
    </div>
</div>

<div id="game-view">
    <div id="top-ui">
        <button class="btn" onclick="location.reload()">üè† ANA MEN√ú</button>
    </div>

    <div id="car-data">Skor: <span id="score-val">0</span></div>

    <div id="mc-setup">
        <h2 style="color:var(--p)">Minecraft Online</h2>
        <div id="id-display" style="margin-bottom:10px">ID'niz olu≈üturuluyor...</div>
        <input type="text" id="target-id" placeholder="Arkada≈ü ID'si" style="padding:10px; border-radius:5px; border:none; width:220px; margin-bottom:10px;">
        <br>
        <button onclick="startMC(true)" style="background:var(--p); padding:10px 25px; border:none; border-radius:5px; font-weight:bold; cursor:pointer;">D√úNYAYA KATIL</button>
        <button onclick="startMC(false)" style="margin-left:10px; background:#666; color:white; padding:10px 25px; border:none; border-radius:5px; cursor:pointer;">TEK OYNA</button>
    </div>
    <div id="crosshair">+</div>
</div>

<script>
let scene, camera, renderer, activeGame = null;

function clearCanvas() {
    const view = document.getElementById('game-view');
    const oldCanvas = view.querySelector('canvas');
    if(oldCanvas) view.removeChild(oldCanvas);
}

function initGame(type) {
    activeGame = type;
    document.getElementById('portal').style.display = 'none';
    document.getElementById('game-view').style.display = 'block';
    clearCanvas();

    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.getElementById('game-view').appendChild(renderer.domElement);

    if(type === 'car') {
        setupCar();
    } else {
        setupMC();
    }
}

// --- ARABA OYUNU Sƒ∞STEMƒ∞ ---
function setupCar() {
    document.getElementById('car-data').style.display = 'block';
    scene.background = new THREE.Color(0x87CEEB);
    const ambient = new THREE.AmbientLight(0xffffff, 0.6); scene.add(ambient);
    const sun = new THREE.DirectionalLight(0xffffff, 1); sun.position.set(5,10,5); scene.add(sun);

    const road = new THREE.Mesh(new THREE.PlaneGeometry(10, 1000), new THREE.MeshPhongMaterial({color: 0x333333}));
    road.rotation.x = -Math.PI/2; scene.add(road);

    const car = new THREE.Group();
    const body = new THREE.Mesh(new THREE.BoxGeometry(1.2, 0.5, 2.5), new THREE.MeshPhongMaterial({color: 0x00ff88}));
    body.position.y = 0.5; car.add(body);
    scene.add(car);

    camera.position.set(0, 3, 6);
    let speed = 0.2;
    let score = 0;
    let keys = {};
    window.onkeydown = e => keys[e.code] = true;
    window.onkeyup = e => keys[e.code] = false;

    function loop() {
        if(activeGame !== 'car') return;
        requestAnimationFrame(loop);
        if(keys['KeyA'] && car.position.x > -4) car.position.x -= 0.1;
        if(keys['KeyD'] && car.position.x < 4) car.position.x += 0.1;
        score++;
        document.getElementById('score-val').innerText = score;
        renderer.render(scene, camera);
    }
    loop();
}

// --- MINECRAFT Sƒ∞STEMƒ∞ ---
function setupMC() {
    document.getElementById('mc-setup').style.display = 'flex';
    const peer = new Peer('Pixel-' + Math.floor(Math.random()*9000 + 1000));
    peer.on('open', id => document.getElementById('id-display').innerText = "Senin ID: " + id);
}

function startMC(isOnline) {
    document.getElementById('mc-setup').style.display = 'none';
    document.getElementById('crosshair').style.display = 'block';
    document.body.requestPointerLock();
    
    scene.background = new THREE.Color(0x87ceeb);
    scene.add(new THREE.AmbientLight(0xffffff, 0.7));
    
    for(let x=-8; x<8; x++) {
        for(let z=-8; z<8; z++) {
            const b = new THREE.Mesh(new THREE.BoxGeometry(1,1,1), new THREE.MeshStandardMaterial({color: 0x4caf50}));
            b.position.set(x, 0, z); scene.add(b);
        }
    }

    camera.position.set(0, 2, 5);
    let keys = {}, yaw = 0, pitch = 0;
    window.onkeydown = e => keys[e.code] = true;
    window.onkeyup = e => keys[e.code] = false;
    window.onmousemove = e => {
        if(document.pointerLockElement) {
            yaw -= e.movementX * 0.002; pitch -= e.movementY * 0.002;
            camera.rotation.set(pitch, yaw, 0);
        }
    };

    function loop() {
        if(activeGame !== 'mc') return;
        requestAnimationFrame(loop);
        if(document.pointerLockElement) {
            if(keys['KeyW']) camera.translateZ(-0.1);
            if(keys['KeyS']) camera.translateZ(0.1);
        }
        renderer.render(scene, camera);
    }
    loop();
}
</script>
</body>
</html>
